#Variables
EXE1=des
EXE2=genkey
INCDIR=../include/

#Usual compilation flags
CFLAGS=-std=c99 -Wall -Wextra -g -O2
CPPFLAGS=-I../include -DDEBUG
LDFLAGS=-lm

#Special rules and targets
.PHONY: all clean help genkey

#Rules and targets

all: $(EXE1) $(EXE2)

$(EXE1): decrypt.o encrypt.o main.o
	$(CC) $(CFLAGS) -o $@ $^ $(LDFLAGS)

main.o: main.c decrypt.h encrypt.h genkey.h
	$(CC) $(CFLAGS) $(CPPFLAGS) -c $<

decrypt.o: decrypt.c decrypt.h
	$(CC) $(CFLAGS) $(CPPFLAGS) -c $<

encrypt.o: encrypt.c encrypt.h
	$(CC) $(CFLAGS) $(CPPFLAGS) -c $<

$(EXE2): genkey.o
	$(CC) $(CFLAGS) -o $@ $^ $(LDFLAGS)

genkey.o: genkey.c genkey.h
	$(CC) $(CFLAGS) $(CPPFLAGS) -c $<

clean:
	@rm -f *~ *.o $(EXE1) $(EXE2)

help :
	@echo -e "Usage :"
	@echo -e "  make [all]		build the software"
	@echo -e "  make des		build des"
	@echo -e "  make clean		remove all files generated by make"
	@echo -e "  make help		display this help"
